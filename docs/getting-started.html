<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Crane is a Docker orchestration tool similar to Docker Compose with extra features and ultra-fast bind-mounts on macOS.">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="manifest.json">
  
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Bungee|Lato" rel="stylesheet">
  <style>
  body {
    font-family: 'Lato', sans-serif;
  }
  .crane-header {
    font-family: 'Bungee', cursive;
  }
  .nav-item {
    text-transform: uppercase;
  }
  .nav-link.active {
    color: #292b2c;
  }
  .code-block {
    background: #f7f7f9;
    color: #bd4147;
    padding: .2rem .4rem;
    border-radius: .25rem;
    margin-bottom: 15px;
  }
  .code-block pre {
    color: #bd4147;
    margin-bottom: 3px;
  }
  table.table-condensed td, table.table-condensed th {
    padding: 0.25rem 0.75rem 0.25rem 0;
  }
  ul.ticks li:before {
    content: "\2714";
    margin-right: 10px;
  }
  ul.ticks li {
    list-style: none;
    margin: 10px 0;
    font-size: 120%;
  }
  .stripe-button-el span {
    height: 50px !important;
    line-height: 50px !important;
    padding: 0 20px !important;
  }
  h3 {
    margin-top: 60px;
  }
  code {
    white-space: nowrap;
  }
  pre code {
    white-space: pre-wrap;
  }
  #docs-navigation {
    list-style: none;
    background: #F5F4F0;
    border-radius: 5px;
    padding: 2px 0;
    float: right;
  }
  #docs-navigation > li {
    font-weight: bold;
    border-bottom: 1px solid #fff;
    padding: 3px 15px;
  }
  #docs-navigation > li ul {
    font-weight: normal;
    padding-left: 25px;
  }
  </style>
  <title>Crane</title>
  
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-93517487-1', 'auto');
      ga('send', 'pageview');

    </script>
  
</head>
<body>
  <div class="container" style="margin-top: 15px">
    <div class="row" style="float: left">
    <div class="col" style="margin-bottom: 20px;">
      <img src="images/logo.png" style="width: 50px; height: 50px; border-radius: 50%; border-color: #75C9B1; border-style: solid; border-width: 2px; float: left; margin-right: 10px" />
      <a href="" style="color: #292b2c; font: 24px 'Bungee', cursive; margin-top: 14px; margin-bottom: 0; line-height: 24px; float: left">CRANE</a>
    </div>
  </div>
    <ul class="nav justify-content-end" style="padding-top: 5px">
      <li class="nav-item">
        <a class="nav-link " href="installation.html">Installation</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="getting-started.html">Getting Started</a>
      </li>
      <li class="nav-item">
        <a class="nav-link " href="docs.html">Docs</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/michaelsauter/crane">Github</a>
      </li>
    </ul>
  
</div>
<div class="container-fluid" style="clear: both;background: #F5F4F0; padding-top: 20px; padding-bottom: 20px">
  <div class="container">
    <div class="row">
      <div class="col-8">
        Crane is a Docker orchestration tool similar to Docker Compose<br/>with extra features and <a href="pro.html"><b>ultra-fast bind-mounts on Mac</b></a>.
      </div>
      <div class="col-4" style="text-align: right; margin-top: auto; margin-bottom: auto">
        <a class="btn btn-success" href="pro.html" role="button">Check out PRO</a>
      </div>
    </div>
  </div>
</div><div class="container" style="padding-top: 40px">

<p><b>Welcome to Crane! You can either:</b></p>
<ul>
  <li>learn how to use Crane with an <a href="#existing-project">existing docker-compose project</a> or</li>
  <li><a href="#new-project">setup a new project</a> from scratch (we'll use Rails as an example)</li>
</ul>

<p>&nbsp;</p>

<h2><a id="existing-project" class="anchor" href="#existing-project"></a>Existing docker-compose project</h2>

<p>If you already have an existing project, it is easy to use Crane instead of docker-compose to get <a href="pro.html">fast bind-mounts</a>! In general, you only need to add a small snippet to tell Crane which folders should be accelerated.</p>

<p>In this example, we'll assume a Rails project with the following <code>docker-compose.yml</code>:</p>

<div class="code-block">
    <pre><code>services:
  postgres:
    image: postgres:9.6.2
    env:
      - "POSTGRES_USER=example"
      - "POSTGRES_PASSWORD=secret"
      - "POSTGRES_DB=example_development"
  web:
    depends_on:
      - "postgres"
    build:
      context: .
    tty: true
    stdin_open: true
    ports:
      - "3000:3000"
    volumes:
      - ".:/web"
    command: "bin/rails s -b 0.0.0.0"</code></pre>
</div>

<p>All you need to do is create a separate <code>crane.yml</code> in the same folder. Crane will automatically merge both config files together. The file should look like this:</p>

<div class="code-block">
<pre><code>accelerated-mounts:
  web:
    uid: 1000
    gid: 1000</code></pre>
</div>

<p>That's it. Next time you start the "web" service, it'll be fast! Try it out now: <code>crane run example</code>.</p>

<p>&nbsp;</p>

<h2><a id="new-project" class="anchor" href="#new-project"></a>New project from scratch</h2>

<p>We're going to walk through all steps required to setup a new Rails project, but if you use another language / framework, most things should be very similar and you can adapt as needed. For the purposes of this guide, let's assume we name our project "example", so we create a new folder <code>example</code>, which is where all files mentioned below are to be placed.</p>

<p>After you have <a href="installation.html">installed Crane</a>, let's start by creating a configuration file. Following is the Crane format (which strictly follows the flag names of <code>docker run</code>), but you can also use the docker-compose format. An example of that can be seen in the section about using an <a href="#existing-project">existing project</a> with Crane.</p>

<p>This is how the <code>crane.yml</code> looks like:</p>
<div class="code-block">
    <pre><code>services:
  postgres:
    image: postgres:9.6.2
    env:
      - "POSTGRES_USER=example"
      - "POSTGRES_PASSWORD=secret"
      - "POSTGRES_DB=example_development"
  example:
    requires: ["postgres"]
    build:
      context: .
    publish: ["3000:3000"]
    volume: [".:/example"]
    tty: true
    interactive: true
    command: "bin/rails s -b 0.0.0.0"

accelerated-mounts:
  example:
    uid: 1000
    gid: 1000</code></pre>
</div>  

<p>
  We are using the official PostgreSQL image for the database and will build our own image for the example app. Let's write the <code>Dockerfile</code> for it:
</p>

<div class="code-block">
  <pre><code>FROM ruby:2.3.3

RUN apt-get update -qq && apt-get install -y build-essential libpq-dev nodejs

RUN useradd -m -s /bin/bash example; \
    chgrp -R example /usr/local; \
    find /usr/local -type d | xargs chmod g+w; \
    mkdir -p /etc/sudoers.d; \
    echo "example ALL=(ALL) NOPASSWD: ALL" >> /etc/sudoers.d/example; \
    chmod 0440 /etc/sudoers.d/example

ENV HOME /home/example

USER example

RUN gem install rails --no-ri --no-rdoc

WORKDIR /example

ENV BUNDLE_PATH /example/vendor/bundle</code></pre>
</div>

<p>Now we are ready to build this image and create a new Rails project. Crane's <code>up</code> command can do both at the same time for us:</p>
<div class="code-block"><code>crane up example rails new . --force --database=postgresql --skip bundle</code></div>

<p>To configure our app to talk to the Postgres container, edit <code>config/database.yml</code> and uncomment <code>password: secret</code> and <code>host: postgres</code> under the <code>development</code> section. One last step is to install the dependencies:</p>

<div class="code-block"><code>crane run example bundle install</code></div>

<p>Finally, start the server with <code>crane run example</code> and check out the result at <code>http://localhost:3000</code>.</p>

</div>

  <div class="container">
    <div class="row" style="margin-top: 40px; margin-bottom: 40px">
      <div class="col">
        Copyright &copy; 2020 Michael Sauter
      </div>
    </div>
  </div>
</body>
</html>
