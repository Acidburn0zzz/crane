<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description" content="Crane is a Docker orchestration tool similar to Docker Compose with extra features and ultra-fast bind-mounts on macOS.">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="manifest" href="manifest.json">
  
    <link rel="canonical" href="https://michaelsauter.github.io/crane/docs-cli.html" />
  
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css?family=Bungee|Lato" rel="stylesheet">
  <style>
  body {
    font-family: 'Lato', sans-serif;
  }
  .crane-header {
    font-family: 'Bungee', cursive;
  }
  .nav-item {
    text-transform: uppercase;
  }
  .nav-link.active {
    color: #292b2c;
  }
  .code-block {
    background: #f7f7f9;
    color: #bd4147;
    padding: .2rem .4rem;
    border-radius: .25rem;
    margin-bottom: 15px;
  }
  .code-block pre {
    color: #bd4147;
    margin-bottom: 3px;
  }
  table.table-condensed td, table.table-condensed th {
    padding: 0.25rem 0.75rem 0.25rem 0;
  }
  ul.ticks li:before {
    content: "\2714";
    margin-right: 10px;
  }
  ul.ticks li {
    list-style: none;
    margin: 10px 0;
    font-size: 120%;
  }
  .stripe-button-el span {
    height: 50px !important;
    line-height: 50px !important;
    padding: 0 20px !important;
  }
  h3 {
    margin-top: 60px;
  }
  code {
    white-space: nowrap;
  }
  pre code {
    white-space: pre-wrap;
  }
  #docs-navigation {
    list-style: none;
    background: #F5F4F0;
    border-radius: 5px;
    padding: 2px 0;
    float: right;
  }
  #docs-navigation > li {
    font-weight: bold;
    border-bottom: 1px solid #fff;
    padding: 3px 15px;
  }
  #docs-navigation > li ul {
    font-weight: normal;
    padding-left: 25px;
  }
  </style>
  <title>Crane</title>
  
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-93517487-1', 'auto');
      ga('send', 'pageview');

    </script>
  
</head>
<body>
  <div class="container" style="margin-top: 15px">
    <div class="row" style="float: left">
    <div class="col" style="margin-bottom: 20px;">
      <img src="images/logo.png" style="width: 50px; height: 50px; border-radius: 50%; border-color: #75C9B1; border-style: solid; border-width: 2px; float: left; margin-right: 10px" />
      <a href="" style="color: #292b2c; font: 24px 'Bungee', cursive; margin-top: 14px; margin-bottom: 0; line-height: 24px; float: left">CRANE</a>
    </div>
  </div>
    <ul class="nav justify-content-end" style="padding-top: 5px">
      <li class="nav-item">
        <a class="nav-link " href="installation.html">Installation</a>
      </li>
      <li class="nav-item">
        <a class="nav-link " href="getting-started.html">Getting Started</a>
      </li>
      <li class="nav-item">
        <a class="nav-link active" href="docs.html">Docs</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/michaelsauter/crane">Github</a>
      </li>
    </ul>
  
</div>
<div class="container-fluid" style="clear: both;background: #F5F4F0; padding-top: 20px; padding-bottom: 20px">
  <div class="container">
    <div class="row">
      <div class="col-8">
        Crane is a Docker orchestration tool similar to Docker Compose<br/>with extra features and <a href="pro.html"><b>ultra-fast bind-mounts on Mac</b></a>.
      </div>
      <div class="col-4" style="text-align: right; margin-top: auto; margin-bottom: auto">
        <a class="btn btn-success" href="pro.html" role="button">Check out PRO</a>
      </div>
    </div>
  </div>
</div><div class="container">
  <div class="row" style="margin-top: 40px">
    <div class="col-3">
      <ul id="docs-navigation">
<li>
  <a href="docs-cli.html">Command Line Interface</a>
  <ul>
    <li><a href="docs-cli.html#adjusting-targets">Adjusting targets</a></li>
    <li><a href="docs-cli.html#ad-hoc-containers">Ad hoc containers</a></li>
    <li><a href="docs-cli.html#custom-commands">Custom commands</a></li>
  </ul>
</li>
<li>
  <a href="docs-config.html">Configuration</a>
  <ul>
    <li><a href="docs-config.html#services">Services</a></li>
    <li><a href="docs-config.html#networks">Networks</a></li>
    <li><a href="docs-config.html#volumes">Volumes</a></li>
    <li><a href="docs-config.html#groups">Groups</a></li>
  </ul>
</li>
<li><a href="docs-accelerated-mounts.html">Accelerated Mounts</a></li>
<li>
  <a href="docs-advanced.html">Advanced Usage</a>
  <ul>
    <li><a href="docs-advanced.html#prefixing">Prefixing</a></li>
    <li><a href="docs-advanced.html#hooks">Hooks</a></li>
    <li><a href="docs-advanced.html#parallelism">Parallelism</a></li>
    <li><a href="docs-advanced.html#override-image-tag">Override image tag</a></li>
    <li><a href="docs-advanced.html#generate-command">Generate command</a></li>
    <li><a href="docs-advanced.html#yaml-alias-merge">YAML alias/merge</a></li>
    <li><a href="docs-advanced.html#variable-expansion">Variable expansion</a></li>
  </ul>
</li>
<li><a href="docs-compatibility.html">Compatibility notes</a></li>
<li><a href="docs-updating.html">Updating</a></li>

</ul>

    </div>
    <div class="col-9">
        
<h2><a id="cli" class="anchor" href="#cli"></a>Command Line Interface</h2>

<p>Crane is a very light wrapper around the Docker CLI. This means that most
commands just call the corresponding Docker command, but for all targeted
services. The basic format is <code>crane &lt;command&gt; &lt;target&gt;</code>, where <code>&lt;command&gt;</code>
corresponds to a Docker command, and <code>&lt;target&gt;</code> either is a single container or
a <a href="docs-config.html#groups">group</a>.</p>

<p>When executing commands, keep the following 2 rules in mind:</p>

<ol>
<li>Crane will apply the command ONLY to the target</li>
<li>Crane will do with other services in the configuration whatever it takes in
order for (1) to succeed</li>
</ol>

<p>As an example, imagine you have a container <code>web</code> depending on container
<code>database</code>. When you execute <code>crane run web</code>, then Crane will start <code>database</code>
first, then run <code>web</code> (recreating <code>web</code> if it already exists).</p>

<div class="code-block">
  <pre><code>usage: crane [&lt;flags&gt;] &lt;command&gt; [&lt;args&gt; ...]

Lift containers with ease - https://www.crane-orchestration.com

Flags:
      --help                    Show context-sensitive help (also try
                                --help-long and --help-man).
  -v, --verbose                 Enable verbose output.
      --dry-run                 Dry run (implicitly verbose; no side effects).
  -c, --config=~/crane.yml ...  Location of config file(s).
  -p, --prefix=PREFIX           Container/Network/Volume prefix.
  -x, --exclude=container|group ...  
                                Exclude group or container (repeatable).
  -o, --only=container|group    Limit scope to group or container.
  -e, --extend                  Extend command from target to dependencies.
      --tag=TAG                 Override image tags.

Commands:
  help [&lt;command&gt;...]
    Show help.


  up [&lt;flags&gt;] [&lt;target&gt;] [&lt;cmd&gt;...]
    Build or pull images if they don't exist, then run or start the containers.
    Alias of `lift`.

    -n, --no-cache    Build the image(s) without any cache.
    -l, --parallel=1  Define how many containers are provisioned in parallel.
    -d, --detach      Detach from targeted container.

  lift [&lt;flags&gt;] [&lt;target&gt;] [&lt;cmd&gt;...]
    Build or pull images if they don't exist, then run or start the containers.
    Alias of `up`.

    -n, --no-cache    Build the image(s) without any cache.
    -l, --parallel=1  Define how many containers are provisioned in parallel.
    -d, --detach      Detach from targeted container.

  run [&lt;flags&gt;] [&lt;target&gt;] [&lt;cmd&gt;...]
    Run containers. Already existing containers will be removed first.

    -d, --detach  Detach from container.

  create [&lt;target&gt;] [&lt;cmd&gt;...]
    Create containers. Already existing containers will be removed first.


  start [&lt;target&gt;]
    Start stopped containers. Non-existant containers will be created.


  stop [&lt;target&gt;]
    Stop running containers.


  kill [&lt;target&gt;]
    Kill running containers.


  exec [&lt;flags&gt;] [&lt;target&gt;] [&lt;cmd&gt;...]
    Execute command in the targeted container(s). Stopped containers will be
    started, non-existant containers will be created first.

    --privileged  Give extended privileges to the process.
    --user=USER   Run the command as this user.

  rm [&lt;flags&gt;] [&lt;target&gt;]
    Remove stopped containers.

    -f, --force    Remove running containers, too.
        --volumes  Remove volumes as well.

  pause [&lt;target&gt;]
    Pause running containers.


  unpause [&lt;target&gt;]
    Unpause paused containers.


  provision [&lt;flags&gt;] [&lt;target&gt;]
    Build or pull images.

    -n, --no-cache    Build the image(s) without any cache.
    -l, --parallel=1  Define how many containers are provisioned in parallel.

  pull [&lt;target&gt;]
    Pull images.


  push [&lt;target&gt;]
    Push containers to the registry.


  logs [&lt;flags&gt;] [&lt;target&gt;]
    Show container logs.

    -f, --follow       Follow log output.
        --tail=TAIL    Define number of lines to display at the end of the logs.
    -t, --timestamps   Show timestamps.
    -z, --colorize     Use different color for each container.
        --since=SINCE  Show logs since timestamp.

  stats [&lt;flags&gt;] [&lt;target&gt;]
    Display statistics about containers.

    -n, --no-stream  Disable stats streaming.

  status [&lt;flags&gt;] [&lt;target&gt;]
    Display status of containers (similar to `docker ps`).

    -n, --no-trunc  Don't truncate output.

  cmd [&lt;command&gt;] [&lt;arguments&gt;...]
    Execute predefined shortcut command.


  generate [&lt;flags&gt;] [&lt;target&gt;]
    Generate files by passing the config to given template.

    -t, --template=TEMPLATE  Template to use.
    -O, --output=OUTPUT      The file(s) to write the output to.

  am reset [&lt;target&gt;]
    Reset accelerated mount.


  am logs [&lt;flags&gt;] [&lt;target&gt;]
    Show logs of accelerated mount.

    -f, --follow  Follow log output.

  version [&lt;flags&gt;]
    Display the current version and check for updates.

    -n, --no-check  Don't check for updates.


</code></pre>
</div>

<div class="alert alert-info" role="alert">
  You can get more information about what's happening behind the scenes for all commands by using <code>--verbose</code>. Most options have a short version as well, e.g. <code>up -n</code>. The CLI provides help for every command, e.g. <code>crane help run</code>.
</div>

<h3><a id="adjusting-targets" class="anchor" href="#adjusting-targets"></a>Adjusting targets</h3>

<p>By default, Crane will apply the command ONLY to the target. For example, if you have a container <code>web</code> that depends on a container <code>db</code>, then executing <code>crane run web</code> will make sure that <code>db</code> is started before running <code>web</code> (recreating it if it already exists). If you want to <b>extend the target</b> - in this example to recreate <code>db</code> as well if it already exists - you can use <code>--extend</code></p>

<p>If you want to <b>exclude a container</b> or a whole group from a Crane command, you
can specify this with <code>--exclude &lt;reference&gt;</code> (or via <code>CRANE_EXCLUDE</code>). The
flag can be repeated to exclude several services or groups (use a multi-line
environment variable value to pass several references via <code>CRANE_EXCLUDE</code>). Excluded services' declaration <em>and</em> references in the configuration file
will be completely ignored, so their dependencies will also be excluded
(unless they are also required by other non-excluded services).</p>

<p>Apart from excluding services, it is also possible to <b>limit the target</b> to just
one container or group with <code>--only</code> (or via <code>CRANE_ONLY</code>). The flag cannot be
repeated. Containers outside the targets will not be considered by Crane then.</p>

<h3><a id="ad-hoc-containers" class="anchor" href="#ad-hoc-containers"></a>Ad hoc containers</h3>

<p>If you append a command to <code>up</code>/<code>lift</code> or <code>run</code>, Crane will add a timestamp
to the container name (e.g. <code>foo</code> will become <code>foo-1447155694523</code>), making it
possible to have multiple containers based on the same Crane config.</p>

<div class="alert alert-warning" role="alert">
  Ad-hoc containers will have <code>ip</code>, <code>ip6</code>, <code>publish</code>, <code>publish-all</code> and <code>detach</code> disabled, and <code>rm</code> enabled.
</div>

<h3><a id="custom-commands" class="anchor" href="#custom-commands"></a>Custom commands</h3>

<p>Often you'll want to execute the same command inside a container over and over again. Crane allows to define shortcuts for them in the configuration, which can be executed via <code>crane cmd</code>. For example, you can define <code>console: run web bin/rails c</code> inside the <code>commands</code> section of the configuration to run an ad-hoc <code>web</code> container with the <code>rails c</code> command inside by simply executing <code>crane cmd console</code> from the host. This is effectively the same as running the longer <code>crane run web bin/rails c</code>.</p>

<p>The shortcuts can be defined as strings or arrays, and may start with any valid Crane subcommand. That means you can use them to run containers, or execute commands inside existing containers etc. The CLI interface accepts further arguments, which are simply appended to the predefined command. It is possible to list available commands by typing just <code>crane cmd</code>. Some examples:</p>

<div class="code-block">
  <pre><code>commands:
  console: run web bin/rails c
  server: run web
  rspec: run web bin/rspec
  rubocop: run web bin/rubocop
  psql: exec postgres psql</code></pre>
</div>

<p>Usage is simple: <code>crane cmd console</code> would start a Rails console in the default (development) environment, and using <code>crane cmd console test</code> would append <code>test</code> to the predefined command, starting a console in the test environment.</p>

    </div>
  </div>
</div>

  <div class="container">
    <div class="row" style="margin-top: 40px; margin-bottom: 40px">
      <div class="col">
        Copyright &copy; 2020 Michael Sauter
      </div>
    </div>
  </div>
</body>
</html>
